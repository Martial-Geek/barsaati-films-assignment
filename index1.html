<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./globals.css" />
    <title>Twitter Trending Topics</title>

    <script>
      function runSeleniumScript() {
        fetch("/run-selenium")
          .then((response) => response.json())
          .then((data) => {
            const resultsElement = document.getElementById("results");
            resultsElement.innerHTML = "";

            // Create a header for the trending topics
            const header = document.createElement("h2");
            header.innerText = "Trending Topics:";
            resultsElement.appendChild(header);

            // Create a list for the trending topics
            const topicsList = document.createElement("ul");

            // Iterate through trending topics and add them to the list
            data.trendingTopics.forEach((topic) => {
              const topicItem = document.createElement("li");
              topicItem.innerText = topic.split("\n")[0]; // Display only the topic name
              topicsList.appendChild(topicItem);
            });

            // Add the list of trending topics to the results element
            resultsElement.appendChild(topicsList);

            // Create a footer for additional information
            const footer = document.createElement("div");
            const formattedDate = new Date(data.endTime).toLocaleString();
            footer.innerHTML = `These are the most happening topics as on ${formattedDate}<br>`;

            // Add the IP address to the footer
            footer.innerHTML += `The IP address used for this query was ${data.ipAddress}`;
            resultsElement.appendChild(footer);
          })
          .catch((error) => {
            // Display error message if fetching data fails
            document.getElementById("results").innerText =
              "Error running Selenium script";
          });
      }
    </script>
  </head>
  <body>
    <h1>Twitter Trending Topics</h1>
    <button onclick="runSeleniumScript()">Get Trending Topics</button>
    <div id="results"></div>
  </body>
</html>
